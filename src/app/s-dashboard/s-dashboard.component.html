<div class="container login-container">
  <div class="login-border">  
    <form (submit)="submitEvaluation()">
      <div class="error-container" [@errorAnimation]="error ? 'animate' : 'nothing'">
        <div class="form-error">
          <p *ngIf="error">{{error}}</p>
        </div>
      </div>

      <mat-stepper linear #student_stepper>
        <mat-step [completed]="(department && course && lecturer) ? true : false">
          <div class="form-group">
            <mat-form-field class="form-field">
              <mat-label>Department</mat-label>
              <mat-select name="department" [disabled]="deptIsDisabled" [value]="department">
                <mat-option [value]="department">
                  {{department}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="form-group">
            <mat-form-field class="form-field">
              <mat-label>Course</mat-label>
              <mat-select name="course" (valueChange)="formValueChanged($event, 'course')">
                <mat-option *ngFor="let course of courses" [value]="course">
                  {{course}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="form-group">
            <mat-form-field class="form-field">
              <mat-label>Lecturer</mat-label>
              <mat-select name="lecturer" (valueChange)="formValueChanged($event, 'lecturer')">
                <mat-option *ngFor="let lecturer of lecturers" [value]="lecturer">
                  {{lecturer}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="form-group-btn">
            <button mat-raised-button class="login-btn" [disabled]="formIsDisabled"
              type="button" matStepperNext>Begin</button>
          </div>
        </mat-step>
        <mat-step *ngFor="let questions of questionsArray, let questionGroup = index">
          <div class="form-group-questions" *ngFor="let question of questions, let questionNo = index">
            <label for="question.title">{{questionNo + 1}}. {{question.title}}</label>
            <ngb-rating [max]="5" [readonly]="false" [(rate)]="question.rate">
              <!-- provides custom layout -->
              <ng-template let-fill="fill" let-index="index">
                <span class="star" [class.filled]="fill === 100" [class.bad]="index <= 1" 
                  [class.average]="index === 2" [class.great]="index > 2">
                  &#9733;
                </span>
              </ng-template>
            </ngb-rating>
          </div>

          <div class="form-group-btn" *ngIf="!(questionGroup === (questions.length - 1))">
            <button mat-raised-button class="login-btn" [disabled]="formIsDisabled"
              type="button" matStepperPrevious>Previous</button>
            <button mat-raised-button class="login-btn next-btn" [disabled]="formIsDisabled"
              type="button" matStepperNext>Next</button>
          </div>

          <div class="form-group-btn" *ngIf="questionGroup === (questions.length - 1)">
            <button mat-raised-button class="login-btn" [disabled]="formIsDisabled"
              type="button" matStepperPrevious>Previous</button>
            <button mat-raised-button class="login-btn next-btn" [disabled]="formIsDisabled">Submit Evaluation</button>
          </div>
        </mat-step>
      </mat-stepper>
    </form>
  </div>
</div>